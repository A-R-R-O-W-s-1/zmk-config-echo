/ {
    chosen {
        zmk,kscan = &kscan_left &kscan_right;
    };

    kscan_left: kscan {
        compatible = "zmk,kscan-gpio-matrix";
        wakeup-source;
        diode-direction = "col2row";
        row-gpios
            = <&pro_micro 0 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&pro_micro 1 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&pro_micro 10 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&pro_micro 16 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&pro_micro 2 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            ;
        col-gpios
            = <&pro_micro 21 GPIO_ACTIVE_HIGH>
            , <&pro_micro 9 GPIO_ACTIVE_HIGH>
            , <&pro_micro 19 GPIO_ACTIVE_HIGH>
            , <&pro_micro 18 GPIO_ACTIVE_HIGH>
            , <&pro_micro 15 GPIO_ACTIVE_HIGH>
            , <&pro_micro 14 GPIO_ACTIVE_HIGH>
            ;
    };

    kscan_right: kscan {
        compatible = "zmk,kscan-gpio-matrix";
        wakeup-source;
        diode-direction = "col2row";
        row-gpios
            = <&pro_micro 0 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&pro_micro 1 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&pro_micro 10 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&pro_micro 16 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&pro_micro 2 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            ;
        col-gpios
            = <&pro_micro 14 GPIO_ACTIVE_HIGH>
            , <&pro_micro 15 GPIO_ACTIVE_HIGH>
            , <&pro_micro 18 GPIO_ACTIVE_HIGH>
            , <&pro_micro 19 GPIO_ACTIVE_HIGH>
            , <&pro_micro 20 GPIO_ACTIVE_HIGH>
            , <&pro_micro 21 GPIO_ACTIVE_HIGH>
            ;
    };

    physical_layout {
        compatible = "zmk,physical-layout";
        keys = <
            /* Left half */
            0 0, 1 0, 2 0, 3 0, /* Outer Column */
            0 1, 1 1, 2 1, 3 1, /* Pinky Column */
            0 2, 1 2, 2 2, 3 2, /* Ring Column */
            0 3, 1 3, 2 3, 3 3, /* Middle Column */
            0 4, 1 4, 2 4, 3 4, /* Index Column */
            0 5, 1 5, 2 5, 3 5, /* Inner Column */
            4 4, 4 5,           /* Left Thumb cluster */

            /* Right half (mirrored) */
            0 6, 1 6, 2 6, 3 6, /* Inner Column */
            0 7, 1 7, 2 7, 3 7, /* Index Column */
            0 8, 1 8, 2 8, 3 8, /* Middle Column */
            0 9, 1 9, 2 9, 3 9, /* Ring Column */
            0 10, 1 10, 2 10, 3 10, /* Pinky Column */
            0 11, 1 11, 2 11, 3 11, /* Outer Column */
            4 6, 4 7            /* Right Thumb cluster */
        >;
        position-map = <
            /* Left half */
            0 0, 0 19, 0 38, 0 57,
            19 0, 19 19, 19 38, 19 57,
            38 8.5, 38 27.5, 38 46.5, 38 65.5,
            57 8, 57 27, 57 46, 57 65,
            76 -6.5, 76 12.5, 76 31.5, 76 50.5,
            95 -2, 95 17, 95 36, 95 55,
            81 74, 100 74,

            /* Right half */
            195 -2, 195 17, 195 36, 195 55,
            214 -6.5, 214 12.5, 214 31.5, 214 50.5,
            233 8, 233 27, 233 46, 233 65,
            252 8.5, 252 27.5, 252 46.5, 252 65.5,
            271 0, 271 19, 271 38, 271 57,
            290 0, 290 19, 290 38, 290 57,
            190 74, 209 74
        >;
    };
};
